#summary Instructions on building/compiling PeerBlock.
#labels Featured

= Introduction =

The original base Peer Guardian 2 code was in somewhat rough shape, including (especially?) the Visual Studio project-files.  This page should help you get everything compiling PeerBlock more successfully.


= Prerequisites =

In addition to the code, there are some additional things you'll need to have installed on your machine:

  * Subversion Client (I like TortoiseSVN)
  * MS Visual C++ 2008 (Express Edition is free, and works quite well)
  * MS Windows SDK, v6001.1600 or newer (free download from Microsoft)
  * MS Windows DDK, v6001.16002 for Windows Server 2008 (free download from Microsoft) (only required to build the filter-driver - not necessary if you're just building the peerblock.exe user-mode component)

Additionally, if you'd like to build the Installer package, you'll need to download the [http://files.jrsoftware.org/ispack/isdl.htm#qsp InnoSetup "QuickStart Pack"] (ispack).


= Visual C++ 2008 Express Setup =

You'll need to do a couple funky things to get Visual C++ 2008 Express to be able to compile to 64-bit targets.  If you have a retail/academic version of Visual Studio these steps should not be necessary, however they _are_ with the free Express edition.

See this page for more details: [http://jenshuebel.wordpress.com/2009/02/12/visual-c-2008-express-edition-and-64-bit-targets/ Visual C++ 2008 Express Edition and 64-bit Targets].  Most usefully, scroll down to near the bottom of the page and look for Xia Wei's post linking to a .zip file.  What you'll need to do is to download and install the Windows SDK (yes, even though Visual C++ installs its own copy as well you'll need to download and install it again), then run the .bat file included in Xia Wei's .zip.  Note that if you installed either Visual C++ or the Windows SDK to a location other than the default, you'll need to edit the .bat file to include the correct path-names.


= PeerBlock Project Configuration = 

To build the pbfilter project (i.e. pbfilter.sys, our filter-driver) you'll need to set up an environment variable to point to the directory into which you've installed the DDK.  Create a "User" environment-variable called "PB_WINDDK", and set it equal to the DDK path.


= Done? = 

In theory, once you've performed the above steps you should be able to compile PeerBlock.  Release/Debug versions are for Windows XP/2000, Release (Vista) and Debug (Vista) are for Windows Vista / Windows 7 (and Windows Server 2003 / 2008 as well, I believe).  Win32 builds are for 32-bit systems, x64 is for 64-bit.

In addition to being able to compile through Visual Studio, the build_all.cmd batch-file should be able to automatically launch a rebuild of the entire source tree (all 4 release variants), as well as of the Installer package.

Note that the Win32 Debug and Debug (Vista) builds aren't working yet, so if you try to build those but it fails it's probably not your fault...  A patch for this would be welcome, of course!